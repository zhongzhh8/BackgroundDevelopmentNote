# 第十二章

Http协议具体还是看王道书吧，这里简单回顾一下就ok了。

Http协议（应用层）基于TCP协议（传输层），而Https协议（应用层）基于TLS协议（应用层），TLS协议（应用层）基于TCP协议（传输层），就是说Https协议比Http协议多经过了一个TLS协议。

## 12.1 http工作流程

略

## 12.2 http协议结构

结构：

1. 报文头。只有一行，比如“GET xxx.xxx.com/icon.png”就是用GET方式请求一张图片。
2. 0个或多个请求头。
3. 空行（作为请求头的结束）。
4. 可选的消息体。

报文头的请求方法有：HEAD、GET、POST、DELETE、PUT、PATCH等。

请求头有很多属性，比如Host指定服务器主机和端口，Connection为keep-alive时指定保持连接状态，User-Agent表明客户端信息，cookie携带cookie内容等。

Http返回码是3位数字，其中第一个数字定义了响应的类别：

- 1xx，指示信息，表明请求已接收、继续处理。
- 2xx，成功。
- 3xx，重定向。
- 4xx，客户端错误，请求有语法错误或者请求无法实现。
- 5xx，服务端错误，服务器未能实现合法的请求。



## 12.3 Https协议

http通信容易被窃听，窃听者可以对数据进行篡改。

加密算法有两种：对称加密和非对称加密。

- 对称加密：加密和解密用的是同一个秘钥。（DES、AES算法）计算量小。
- 非对称加密：加密和解密使用不同的秘钥。公钥加密需要私钥解密；私钥加密需要公钥解密。（RSA算法）计算量大，更安全。

综合性能和安全的考虑，一般用非对称加密得出密钥，然后用对称加密算法对消息内容进行加密，再传输。



## 12.4 CGI

CGI（Common Gateway Interfere，通用网关接口），这东西也只有C/C++在用了。

> 以下内容参考[CGI介绍](https://blog.csdn.net/liitdar/article/details/79896457)

web服务器有Apache、Nginx等。

![img](https://img-blog.csdn.net/20180411151204476?watermark/2/text/aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L2xpaXRkYXI=/font/5a6L5L2T/fontsize/400/fill/I0JBQkFCMA==/dissolve/70)

程序员一般都是负责开发CGI程序，大多数的CGI程序被用来解释处理来自表单的输入信息，并在服务器产生相应的处理，或将相应的信息反馈给浏览器，CGI程序使网页具有了交互功能。

**出现背景：**CGI是比较原始的开发动态网站的方式。由于静态的html页面无法实现网站的动态内容的生成，所以就需要由web服务器调用CGI程序，CGI程序生成动态内容，返回给web服务器，web服务器再返回给浏览器。

CGI应用程序能通过Web服务器与浏览器进行交互，还可以通过数据库API与数据库服务器等外部数据源进行通信，从数据库服务器中获取数据，将数据格式化为HTML文档后，发送给浏览器，也可以将从浏览器获得的数据放到数据库中。

**CGI程序处理步骤：**

1. 浏览器通过HTML表单或超链接，请求指向一个CGI应用程序的URL；

2. 服务器收到浏览器发送的请求；

3. 服务器调用执行指定CGI应用程序；

4. CGI应用程序根据相关信息（通常是基于浏览者输入的内容），执行具体的操作；

5. CGI应用程序把操作结果格式化为网络服务器和浏览器能够理解的文档（通常是HTML网页），并发送给web服务器；

6. web服务器把操作结果返回给浏览器。
